# 文件提取归档工具

一款为文件办公场景设计的轻量级、自动化文件合并脚本（基于Windows Batch）。

## 一、功能介绍

本工具旨在解决"多级文件夹内容快速提取"的需求。它可以扫描当前目录、识别所有子文件夹、并将其中的文件一键提取至指定的目标位置。

- **递归深度识别**：自动穿透二级及多级子目录，提取每一层级的所有文件。
- **扁平化增强**：所有文件将被提取至目标文件夹根目录，不再保留原有的复杂目录树。
- **原子性移动逻辑**：移动模式下采用"复制成功后再删除"的逻辑，确保数据安全。
- **自引用保护**：自动识别路径冲突，防止脚本处理到目标文件夹自身。

## 二、操作参数解释

| 参数类别 | 选项 | 含义 |
|---------|------|------|
| 选择范围 | 1 (当前目录全部文件夹) | 选择后会处理扫描到的该目录所有文件夹内容。 |
| 选择范围 | 2 (部分) | 仅处理用户输入的指定 ID 对应的文件夹 (如 1 3)。 |
| 选择模式 | C (Copy) | 仅复制文件，源文件结构及内容完整保留。 |
| 选择模式 | M (Move) | 复制成功后，自动清理删除对应的源文件夹所有内容 (谨慎操作)。 |

## 三、使用流程

### 01. 配置
将脚本置于需要操作的文件夹集合根目录。启动后，控制台将输出所有子文件夹及其对应编号。

### 02. 决策
根据提示输入范围 (1/2)、动作 (C/M) 以及目标文件夹的名称。

### 03. 循环
处理完成后，可选择继续处理其他文件夹或安全退出程序。

## 免责声明

1. 本工具执行扁平化合并操作，若多个子文件夹中包含同名文件，目标文件夹将保留最后一次扫描到的版本（旧文件将被覆盖）。
2. 请确保在执行 M (Move) 模式前已进行必要的备份。因用户操作不当或系统权限问题导致的文件损坏或丢失，开发者不承担法律责任。
3. 脚本不建议在包含系统关键文件的路径下运行，防止误删。

© 2026 By Nazi. 基于 Windows Batch 规范开发。
